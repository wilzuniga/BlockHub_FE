<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Colaboradores - BlockHub</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #000;
            color: #00ff00;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: #111;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #00ff00;
        }
        .success { color: #00ff00; }
        .error { color: #ff0000; }
        .warning { color: #ffaa00; }
        button {
            background: #00ff00;
            color: #000;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        .log {
            background: #000;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            border: 1px solid #333;
            min-height: 200px;
            font-family: monospace;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Test Colaboradores BlockHub</h1>
        <p>P√°gina de diagn√≥stico para verificar errores de colaboradores.html</p>

        <h2>üîß Tests de Carga de Scripts</h2>
        <button onclick="testScriptLoading()">1. üîç Test Carga Scripts</button>
        <button onclick="testClassAvailability()">2. üì¶ Test Clases Disponibles</button>
        <button onclick="testFunctions()">3. ‚öôÔ∏è Test Funciones</button>
        <button onclick="testNavigation()">4. üß≠ Test Navegaci√≥n</button>

        <h2>üìä Resultados</h2>
        <div id="results" class="log">
            Esperando tests...
        </div>

        <h2>üöÄ Acciones</h2>
        <button onclick="openCollaborators()">ü§ù Abrir Colaboradores</button>
        <button onclick="clearResults()">üßπ Limpiar Log</button>
    </div>

    <!-- Scripts en el mismo orden que colaboradores.html -->
    <script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <script src="pinata-config.js"></script>
    <script src="web3-contract-integration.js"></script>

    <script>
        function log(message, type = 'info') {
            const results = document.getElementById('results');
            const timestamp = new Date().toLocaleTimeString();
            const colorClass = type === 'error' ? 'error' : 
                              type === 'success' ? 'success' : 
                              type === 'warning' ? 'warning' : '';
            
            results.innerHTML += `<span class="${colorClass}">[${timestamp}] ${message}</span><br>`;
            results.scrollTop = results.scrollHeight;
        }

        function testScriptLoading() {
            log('üîç Testing script loading...', 'info');
            
            // Test Web3
            if (typeof Web3 !== 'undefined') {
                log('‚úÖ Web3 loaded successfully', 'success');
            } else {
                log('‚ùå Web3 NOT loaded', 'error');
            }

            // Test Ethers
            if (typeof ethers !== 'undefined') {
                log('‚úÖ Ethers.js loaded successfully', 'success');
            } else {
                log('‚ùå Ethers.js NOT loaded', 'error');
            }

            // Test window.ethereum
            if (typeof window.ethereum !== 'undefined') {
                log('‚úÖ MetaMask detected', 'success');
            } else {
                log('‚ö†Ô∏è MetaMask not detected', 'warning');
            }
        }

        function testClassAvailability() {
            log('üì¶ Testing class availability...', 'info');
            
            // Test Web3ContractService
            if (typeof Web3ContractService !== 'undefined') {
                log('‚úÖ Web3ContractService class available', 'success');
                try {
                    const testService = new Web3ContractService();
                    log('‚úÖ Web3ContractService instantiation successful', 'success');
                } catch (error) {
                    log(`‚ùå Web3ContractService instantiation failed: ${error.message}`, 'error');
                }
            } else {
                log('‚ùå Web3ContractService class NOT available', 'error');
            }

            // Test PinataService
            if (typeof PinataService !== 'undefined') {
                log('‚úÖ PinataService class available', 'success');
                try {
                    const testPinata = new PinataService();
                    log('‚úÖ PinataService instantiation successful', 'success');
                } catch (error) {
                    log(`‚ùå PinataService instantiation failed: ${error.message}`, 'error');
                }
            } else {
                log('‚ùå PinataService class NOT available', 'error');
            }
        }

        function testFunctions() {
            log('‚öôÔ∏è Testing function definitions...', 'info');
            
            // Simular las funciones que deber√≠an existir en colaboradores.html
            const expectedFunctions = [
                'handleBackToWallet',
                'goToEditor', 
                'searchRepositories',
                'filterRepositories',
                'refreshRepositories',
                'loadRepositories',
                'updateStats',
                'renderRepositories'
            ];

            let allDefined = true;

            expectedFunctions.forEach(funcName => {
                // Como no estamos en colaboradores.html, solo verificamos que podr√≠amos definirlas
                log(`üîç Function '${funcName}' should be defined in colaboradores.html`, 'info');
            });

            // Test funciones de navegaci√≥n b√°sicas
            try {
                function testHandleBackToWallet() {
                    return 'conectar-wallet.html';
                }
                
                function testGoToEditor() {
                    return 'editor-archivos.html';
                }

                log('‚úÖ Navigation function patterns work correctly', 'success');
            } catch (error) {
                log(`‚ùå Navigation function patterns failed: ${error.message}`, 'error');
            }
        }

        function testNavigation() {
            log('üß≠ Testing navigation links...', 'info');
            
            const expectedFiles = [
                'colaboradores.html',
                'conectar-wallet.html', 
                'editor-archivos.html',
                'index.html'
            ];

            expectedFiles.forEach(async (file) => {
                try {
                    const response = await fetch(file, { method: 'HEAD' });
                    if (response.ok) {
                        log(`‚úÖ File exists: ${file}`, 'success');
                    } else {
                        log(`‚ùå File not found: ${file}`, 'error');
                    }
                } catch (error) {
                    log(`‚ùå Error checking ${file}: ${error.message}`, 'error');
                }
            });
        }

        function openCollaborators() {
            log('ü§ù Opening colaboradores.html...', 'info');
            try {
                window.open('colaboradores.html', '_blank');
                log('‚úÖ Opened colaboradores.html in new tab', 'success');
            } catch (error) {
                log(`‚ùå Error opening colaboradores.html: ${error.message}`, 'error');
            }
        }

        function clearResults() {
            document.getElementById('results').innerHTML = 'Log cleared...<br>';
        }

        // Auto-test al cargar
        window.addEventListener('load', () => {
            log('üöÄ Test page loaded successfully', 'success');
            log('üëÜ Click buttons above to run tests', 'info');
            log('üîç Auto-running basic checks...', 'info');
            
            setTimeout(() => {
                testScriptLoading();
                testClassAvailability();
            }, 1000);
        });
    </script>
</body>
</html>
